# Описание проекта

Задача данного проекта заключается в разработке **рекомендательного системы** для поставщиков на торговой площадке. 

В данном случае рекомендательный система необходима для более активного участия поставщиков в торгах за счет того, 
что им предлагаются более подходящие для них заказы.

Для разработки рекомендательного алгоритма имеется информация о предыдущих заказах и участии поставщиков в них. 
Также известно, какой из поставщиков победил в торгах.

Результат: модель предсказывает подходящие для поставщика id закупок и вероятность победы поставщика. 

## Backend

Backend-часть состоит из 4 блоков: трансформирование сырых данных, рекомендательные модели, модель по
прогнозу победителя закупки и блок получения результатов работы моделей. Для разработки API была выбрана 
библиотека FastAPI.

### Transforming_data

Блок использует сырые данные и преобразует их, вычленяя леммы токенов из текстовых признаков и векторизуя их.
Также в данном блоке генерируются признаки для дальнейшего обучения моделей. Процесс лемматизации текстовых признаков 
работает достаточно долго и использует много оперативной памяти. Помимо этого в данный блок входит деление данных 
на тренировные и тестовые. Для обучения рекомендательных моделей данные делились с стратификацией по полю supplier.

### Recommender

Блок использует предобработанные данные. Предварительно преобразуя данные для отдельного поставщика, программа обучает 
LGBMClassifier для определения релевантных и нерелевантных вариантов. Модели лучше работат для тех поставщиков, у 
которых большое кол-во участий за доступный период. Также перед обучением модели программа сортирует все закупки по 
полю reg_code. Это сделано для того, чтобы ускорить обучения путем удаления явно нерелевантных вариантов.

### Win_predictor

Блок использует преобработанные данные. Задачей этого кода является предсказание, победит ли поставщик в закупке или нет. 
В качестве моделей была выбрана модель CatboostClassifier. В файле notebooks/Win_predictor.ipynb можно найти сравнение 
нескольких моделей и их сочетание. Из-за наличия категориальных признаков с большим кол-вом уникальных значений обучение 
моделей может занимает большое кол-во оперативной памяти.

### Evaluation

Блок использует преобразованные тренировное данные и полупреобразованные тестовые. Из-за затратного процесса векторизации
текстовых признаков было принято решение сделать эту операцию предварительно. Код подбирает релевантные закупки для 
конкретного поставщика, а также предсказывает по всем тестовым данным победителя.

## Frontend

Frontend-часть состоит из меньших по размеру 4 блоков: получение данных, тренировка моделей, разведочный анализ данных и 
получение решений на основе обученных моделей. Для frontend'а был выбран фреймворк Streamlit.

## Models

В данной директории находятся модели, их параметры и метрики качества.
